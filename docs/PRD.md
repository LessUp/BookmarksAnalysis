# Bookmarks Analysis 需求文档（PRD）

## 1. 产品定位

Bookmarks Analysis 是一款 **Local-first / 隐私优先** 的书签资产管理与分析工具：

- 书签数据 **只在本地浏览器内处理与存储**（IndexedDB）。
- 支持从多个浏览器导出的 Netscape Bookmark HTML 文件导入、合并、去重与导出。
- 提供搜索、统计洞察与重复簇工作台，帮助用户整理书签资产。
- 支持 AI 智能分析（BYOK 模式），提供分类、摘要、健康检查等功能。

### 核心原则

- **零云端依赖**：默认不引入任何必须的后端服务。
- **可解释、可审查**：导出结果为标准 HTML/结构化数据，便于用户审查。
- **渐进增强**：性能/AI 等增强能力以"可选能力"形式引入，不影响核心流程。
- **BYOK（Bring Your Own Key）**：AI 功能使用用户自己的 API Key，数据不经过第三方服务器。

## 2. 用户与典型场景

### 目标用户

- 多浏览器/多设备用户（Chrome/Edge/Firefox/Safari 等）。
- 有书签"重复、分类混乱、检索困难"的整理需求。
- 需要离线使用或不希望上传个人数据。
- 希望借助 AI 智能分析书签的用户。

### 典型流程

- 导出多个浏览器书签 HTML → 导入应用 → 合并去重 → 搜索/过滤/洞察 → AI 分析 → 导出（回导浏览器/备份）

## 3. 当前版本现状

当前已具备：
- ✅ 导入、合并去重、IndexedDB 持久化
- ✅ 搜索、仪表盘、重复簇展示
- ✅ HTML 导出、PWA
- ✅ 拖拽导入、搜索高亮
- ✅ 高级过滤、导出选项
- ✅ AI 智能分析（完整功能）

## 4. Roadmap 范围裁剪

下面按"用户价值 / 实现复杂度 / 与 Local-first 一致性"综合评估。

### 4.1 必做（P0）- 已完成 ✅

- **P0-1 导入体验补齐** ✅
- **P0-2 搜索体验升级** ✅
- **P0-3 高级过滤** ✅
- **P0-4 导出能力完善** ✅

### 4.2 推荐做（P1）

- **P1-1 多格式导出**（高性价比）
  - JSON / CSV / Markdown 导出。

- **P1-2 备份与恢复**（Local-first 的关键闭环）
  - 导出/导入 IndexedDB 数据，方便迁移设备。

- **P1-3 Web Worker 性能增强**（按数据规模决定是否提前）
  - 解析/统计/索引构建放到 Worker，避免主线程卡顿。

### 4.3 已完成增强（P2）✅

- **P2-1 AI 智能分析** ✅
  - ✅ 支持 OpenAI、Claude、自定义端点（BYOK 模式）
  - ✅ 书签分类：智能推荐分类和标签
  - ✅ 摘要生成：为书签生成简洁摘要和关键词
  - ✅ 重复分析：智能分析重复组，推荐保留项
  - ✅ 健康检查：识别问题书签并提供建议
  - ✅ 自然语言搜索：用自然语言描述查找书签
  - ✅ 集合报告：生成分析报告，支持 Markdown/HTML 导出
  - ✅ 用量追踪：Token 统计、成本估算、限额控制
  - ✅ 提示词模板：可自定义 AI 提示词
  - ✅ 结果缓存：避免重复调用 API

- **P2-2 批量编辑/标签系统**（大功能，后置）
  - 会引入复杂的数据编辑、冲突处理与更重的 UI。

### 4.4 归档/废弃（建议移出主 Roadmap）

- **Cytoscape 关系网络图**：
  - 用户价值不稳定、实现与交互成本高。
  - 建议从主 Roadmap 移除，若未来确有需求再以实验分支/插件形式引入。

## 5. 验收标准（核心体验）

- **导入/合并**：
  - 支持点击选择 + 拖拽导入；错误提示明确；合并完成后数据持久化。
- **搜索/过滤**：
  - 1000+ 条书签下输入与结果渲染无明显卡顿；命中词高亮；过滤条件可组合。
- **导出**：
  - 可导出合并结果（以及按筛选导出）；文件命名清晰；导出的 HTML 可被主流浏览器正常导入。
- **AI 分析**：
  - 支持 OpenAI/Claude/自定义端点；分析结果准确；用量追踪正常；缓存有效。
- **文档一致性**：
  - `/docs` 与 README 反映的功能与实际一致。

## 6. AI 功能详细需求

### 6.1 API 配置管理
- 支持 OpenAI、Claude、自定义端点
- API Key 安全存储在 IndexedDB
- 连接测试功能
- 模型选择

### 6.2 书签分类
- 智能分析书签内容
- 推荐分类和标签
- 显示置信度
- 支持接受/拒绝

### 6.3 摘要生成
- 为书签生成简洁摘要
- 提取关键词
- 支持批量生成

### 6.4 重复分析
- 分析重复书签组
- 推荐保留项
- 提供推荐理由

### 6.5 健康检查
- 识别问题书签
- 提供修复建议
- 支持忽略功能

### 6.6 自然语言搜索
- 用自然语言描述查找
- 显示查询解释
- 无结果时提供建议

### 6.7 集合报告
- 生成分析报告
- 包含洞察和建议
- 支持 Markdown/HTML 导出

### 6.8 用量追踪
- Token 使用统计
- 成本估算
- 限额控制

### 6.9 提示词模板
- 内置默认模板
- 支持自定义编辑
- 变量替换功能

### 6.10 结果缓存
- 自动缓存分析结果
- 过期策略
- 强制刷新选项
