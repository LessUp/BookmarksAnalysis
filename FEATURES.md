# 功能特性详解

## 📤 上传合并页面

### 核心功能
- **多文件导入**：支持同时选择多个书签 HTML 文件
- **拖拽导入**：拖拽文件到上传区域即可导入
- **格式支持**：Chrome、Firefox、Edge、Safari 导出的 Netscape Bookmark 格式
- **实时统计**：显示原始条目数、合并后数量、重复总数
- **来源文件管理**：展示“已导入文件”列表（按来源文件聚合统计），支持移除单个来源文件并提示重新合并
- **阶段加载提示**：导入/合并过程中展示更细的阶段状态，并在处理期间禁用相关交互避免重复触发

### 智能去重算法
- URL 规范化处理：
  - 协议统一（http/https）
  - 主机名小写转换
  - 端口号标准化
  - 路径尾部斜杠处理
  - 查询参数排序
  - 追踪参数剔除（utm_*, gclid, fbclid 等）
- 保留策略：保留添加时间最早的书签
- 目录合并：智能识别不同浏览器的根目录别名

### 导出功能
- 生成标准 Netscape Bookmark HTML 格式
- 保留完整的文件夹层级结构
- 自动添加日期时间戳到文件名
- 支持导入回任意浏览器

## 📊 仪表盘

### 统计卡片
- **书签总量**：去重后的总数
- **重复数量**：检测到的重复书签数
- **域名数量**：不同域名的统计

### 可视化图表
- **重复占比饼图**：直观展示去重效果
- **Top 10 域名柱状图**：最常收藏的网站
- **按年份新增折线图**：书签增长趋势

### 书签列表
- 可展开/折叠的完整书签列表
- 分页加载（每次 20 条）
- 显示标题、URL、文件夹路径
- 点击直接打开链接（新标签页）

## 🔍 搜索页面

### 搜索能力
- **全文搜索**：基于 MiniSearch 引擎
- **多字段匹配**：标题、URL、文件夹路径
- **模糊匹配**：支持拼写容错
- **前缀匹配**：输入即搜
- **权重优化**：标题权重 > URL 权重 > 路径权重

### 搜索结果
- 高亮显示匹配项
- 显示完整路径信息
- 实时搜索反馈
- 默认展示 50 条，可逐步加载更多

### 高级过滤与导出
- **组合过滤**：支持按域名 / 一级目录 / 目录关键字 / 时间范围过滤（可与搜索组合）
- **导出增强**：支持导出全量或当前筛选结果；支持保留目录结构或平铺导出（不保留目录）

## 🔄 去重工作台

### 功能特点
- **重复簇展示**：按组显示所有重复书签
- **视觉标识**：
  - ✅ 绿色勾：保留的书签
  - 🗑️ 灰色图标：重复项
- **详细信息**：
  - 书签标题和 URL
  - 添加日期
  - 文件夹路径
  - 来源文件
- **保留规则说明**：自动保留添加时间最早的版本

## 🤖 AI 智能分析页面

### 支持的 LLM Provider

- **OpenAI**：GPT-4o、GPT-4o-mini、GPT-4-turbo、GPT-3.5-turbo
- **Claude**：Claude 3.5 Sonnet、Claude 3 Opus、Claude 3 Sonnet、Claude 3 Haiku
- **自定义端点**：支持 OpenAI 兼容 API（如 Ollama、LocalAI、vLLM 等）

### AI 功能

#### 书签分类
- 智能分析书签内容和 URL
- 推荐合适的分类和标签
- 显示置信度评分
- 支持接受/拒绝建议
- 批量处理支持

#### 摘要生成
- 为书签生成简洁摘要
- 提取关键词标签
- 支持单个和批量生成
- 错误时自动 fallback

#### 重复分析
- 智能分析重复书签组
- 推荐保留哪个书签
- 提供详细的推荐理由
- 考虑因素：添加时间、标题质量、路径位置

#### 健康检查
- 识别潜在问题书签
- 问题类型：
  - 无效/过时链接
  - 标题质量问题
  - 分类建议
  - 重复内容
- 提供修复建议
- 支持忽略功能

#### 自然语言搜索
- 用自然语言描述查找书签
- 例如："找出所有关于 React 的教程"
- 显示查询解释
- 无结果时提供建议

#### 集合报告
- 生成书签集合分析报告
- 包含：
  - 总体统计
  - 域名分布
  - 时间趋势
  - AI 洞察
  - 优化建议
- 支持导出 Markdown/HTML

### 配置管理
- **Provider 选择**：OpenAI / Claude / 自定义
- **API Key 管理**：安全存储在 IndexedDB
- **模型选择**：根据 Provider 显示可用模型
- **连接测试**：验证 API Key 有效性
- **参数调整**：Max Tokens、Temperature

### 用量追踪
- **Token 统计**：Prompt / Completion / Total
- **成本估算**：基于模型定价计算
- **按操作统计**：分类/摘要/搜索等
- **限额控制**：
  - 每日 Token 限额
  - 每日成本限额
  - 每月 Token 限额
  - 每月成本限额
- **警告提示**：接近限额时提醒

### 提示词模板
- **内置模板**：分类、摘要、重复分析、健康检查、搜索、报告
- **自定义编辑**：修改模板内容
- **变量支持**：`{{bookmarks}}`、`{{query}}` 等
- **重置功能**：恢复默认模板
- **模板预览**：查看变量替换效果

### 缓存机制
- **自动缓存**：分析结果本地缓存
- **缓存类型**：分类/摘要/重复/健康/搜索/报告
- **过期策略**：可配置过期时间
- **强制刷新**：跳过缓存重新分析
- **缓存管理**：查看统计、清理缓存

## 💾 持久化存储

### IndexedDB 集成
- **自动保存**：合并去重后自动存储
- **页面恢复**：刷新后自动加载数据
- **数据结构**：
  - bookmarks 表：存储所有书签
  - settings 表：存储配置信息
  - aiConfig 表：AI 配置（Provider、API Key、Model）
  - aiCache 表：AI 分析结果缓存
  - aiUsage 表：Token 使用记录
  - aiPrompts 表：自定义提示词模板
  - aiUsageLimits 表：用量限额设置
- **性能优化**：批量写入，索引查询

### 搜索索引
- **MiniSearch 索引**：
  - 自动构建搜索索引
  - 内存中高速查询
  - 支持模糊匹配和前缀搜索

## 🎨 UI/UX 改进

### 视觉设计
- **Tailwind CSS**：现代化响应式设计
- **Lucide Icons**：清晰的图标系统
- **深色主题**：护眼的配色方案
- **渐变背景**：关键区域的视觉强调

### 交互优化
- **加载状态**：旋转加载指示器
- **成功/错误提示**：
  - 绿色：成功操作
  - 红色：错误提示
  - 自动消息提示
- **禁用状态**：按钮状态清晰反馈
- **悬停效果**：交互元素的视觉反馈

### 响应式设计
- **移动端优化**：自适应布局
- **平板适配**：中等屏幕友好
- **桌面体验**：充分利用大屏空间

## 📱 PWA 特性

### 离线支持
- Service Worker 缓存
- 离线访问能力
- 资源预缓存

### 安装体验
- 添加到主屏幕
- 独立窗口运行
- 应用图标和主题色

## 🔐 隐私与安全

### 本地优先
- 所有处理在浏览器内完成
- 无需服务器或云存储
- 数据完全由用户掌控

### 数据存储
- IndexedDB 本地存储
- 不上传任何数据
- API Key 安全存储
- AI 分析结果本地缓存

### 导出控制
- 用户主动触发导出
- 标准格式可审查
- 随时清空数据
