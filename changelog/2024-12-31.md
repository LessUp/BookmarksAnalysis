# Changelog - 2024-12-31

## v0.3.0 - AI 智能分析功能

### 新增功能

#### AI 模块 (`src/ai/`)
- **LLM Provider 适配器**
  - OpenAI 适配器：支持 GPT-4o、GPT-4o-mini、GPT-4-turbo、GPT-3.5-turbo
  - Claude 适配器：支持 Claude 3.5 Sonnet、Claude 3 Opus/Sonnet/Haiku
  - 自定义端点适配器：支持 OpenAI 兼容 API（Ollama、LocalAI、vLLM 等）

- **配置管理服务** (`configService.ts`)
  - API Key 安全存储
  - Provider/Model 管理
  - 连接测试功能

- **提示词模板服务** (`promptService.ts`)
  - 内置 6 个默认模板（分类、摘要、重复分析、健康检查、搜索、报告）
  - 支持自定义编辑
  - 变量替换 `{{variable}}`

- **缓存服务** (`cacheService.ts`)
  - 基于内容哈希的缓存
  - 可配置过期时间
  - 缓存统计和清理

- **用量追踪服务** (`usageService.ts`)
  - Token 使用记录
  - 成本估算（基于模型定价）
  - 限额检查和警告

- **AI 分析服务** (`aiService.ts`)
  - 书签分类：智能推荐分类和标签
  - 摘要生成：为书签生成简洁摘要和关键词
  - 重复分析：智能分析重复组，推荐保留项
  - 健康检查：识别问题书签并提供建议
  - 自然语言搜索：用自然语言描述查找书签
  - 集合报告：生成分析报告，支持 Markdown/HTML 导出

#### 状态管理
- **useAIStore** (`src/store/useAIStore.ts`)
  - 集成所有 AI 服务
  - 统一状态管理
  - 进度追踪

#### UI 组件
- **AI 页面** (`src/pages/AI.tsx`)
  - 配置管理 Tab
  - 分类功能 Tab
  - 摘要功能 Tab
  - 健康检查 Tab
  - 搜索功能 Tab
  - 报告功能 Tab
  - 用量统计 Tab

#### 数据库扩展
- 新增 IndexedDB 表：
  - `aiConfig`：AI 配置
  - `aiCache`：分析结果缓存
  - `aiUsage`：Token 使用记录
  - `aiPrompts`：自定义提示词模板
  - `aiUsageLimits`：用量限额设置

### 测试
- 80 个测试用例，100% 通过
- 使用 fast-check 进行属性测试
- 覆盖所有核心服务

### 文档更新
- 更新 README.md：添加 AI 功能说明
- 更新 FEATURES.md：详细 AI 功能文档
- 更新 docs/DESIGN.md：AI 模块架构说明
- 更新 docs/PRD.md：AI 需求文档

### 技术栈
- TypeScript
- React 18
- Zustand（状态管理）
- Dexie（IndexedDB）
- Vitest + fast-check（测试）
